<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!-- Mirrored from docs.aws.amazon.com/cli/latest/userguide/cli-roles.html by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 08 Jun 2016 08:36:33 GMT -->
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Configure the AWS CLI to assume a role."><title>Assuming a Role - AWS Command Line Interface</title><link rel="home" href="#aws-unified-cli" title="AWS Command Line Interface"><link rel="up" href="cli-chap-getting-started.html" title="Configuring the AWS Command Line Interface"><link rel="prev" href="cli-http-proxy.html" title="Using an HTTP Proxy"><link rel="next" href="cli-command-completion.html" title="Command Completion"><meta name="keywords" content=""><meta name="deployment_region" content="IAD"><meta name="product" content="AWS Command Line Interface"><meta name="guide" content="User Guide"><meta name="guide-locale" content="en_us"><link rel="icon" type="image/ico" href="http://media.amazonwebservices.com/favicon.ico"><link rel="shortcut icon" type="image/ico" href="http://media.amazonwebservices.com/favicon.ico"><link rel="canonical" href="cli-roles.html"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/jquery-ui.min.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/font/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/google-font.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/highlight-default.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/jquery-ui.theme.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/colorbox.css"><link rel="stylesheet" type="text/css" href="http://docs.aws.amazon.com/css/awsdocs.css"><script type="text/javascript" src="http://docs.aws.amazon.com/js/highlight.pack.js"></script><script type="text/javascript" src="http://docs.aws.amazon.com/js/jquery.min.js"></script><script type="text/javascript" src="http://docs.aws.amazon.com/js/jquery-ui.min.js"></script><script type="text/javascript" src="http://docs.aws.amazon.com/js/handlebars.js"></script><script type="text/javascript" src="http://docs.aws.amazon.com/js/jquery.colorbox.js"></script><script type="text/javascript" src="http://docs.aws.amazon.com/js/awsdocs.min.js"></script></head><body id="top"><div id="aws-nav" class="aws-nav-header"><div class="aws-nav-header-left"><div id="aws-nav-flyout-trigger" class="aws-nav-flyout-trigger"><i class="fa fa-bars fa-2x"></i>Menu</div><div class="aws-nav-logo"><a href="https://aws.amazon.com/"><span>Amazon Web Services</span></a></div></div><div id="aws-nav-header-right" class="aws-nav-header-right"><div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div><div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()"><option value="http://docs.aws.amazon.com/de_de/cli/latest/userguide/cli-roles.html">Deutsch</option><option value="/en_us/cli/latest/userguide/cli-roles.html" selected>English</option><option value="http://docs.aws.amazon.com/es_es/cli/latest/userguide/cli-roles.html">Espa&ntilde;ol</option><option value="http://docs.aws.amazon.com/fr_fr/cli/latest/userguide/cli-roles.html">Fran&ccedil;ais</option><option value="http://docs.aws.amazon.com/ja_jp/cli/latest/userguide/cli-roles.html">&#26085;&#26412;&#35486;</option><option value="http://docs.aws.amazon.com/pt_br/cli/latest/userguide/cli-roles.html">Portugu&ecirc;s</option><option value="http://docs.aws.amazon.com/ko_kr/cli/latest/userguide/cli-roles.html">&#54620;&#44397;&#50612;</option><option value="http://docs.aws.amazon.com/zh_cn/cli/latest/userguide/cli-roles.html">&#20013;&#25991; (&#31616;&#20307;)</option></select></div><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator"><div class="aws-nav-left"></div><div class="aws-nav-right"></div></div></div><div id="topnav-flyout-menu-container"><ul id="topnav-flyout-menu"><script id="flyout-item-template" type="text/x-handlebars-template">           
                    {{#flyoutList}}
                    
                    <li>{{listItem}}
                        {{#if subList}}
                        <ul>
                            {{#subList}}
                            <li class="awsdocs-flyout-link-wrapper"><a href="{{target}}">{{text}}</a></li>
                            {{/subList}}
                        </ul>
                        {{/if}}
                    </li>
                    
                    {{/flyoutList}}
                </script></ul><div id="topnav-flyout-menu-spacer"></div></div></div><script type="text/javascript"><!--
						var thispage = "cli-roles.html";
						var tocroot = location.protocol + '//' + location.hostname + location.pathname;
						--></script><div id="content-container"><div id="left-column" class="ui-resizable"><div id="left-col-header"><div id="left-col-top-content"><div id="service-name">AWS Command Line Interface </div><div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div><div id="guide-info">User Guide<div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div></div></div><form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="http://docs.aws.amazon.com/search/doc-search.html"><div id="search-form"><select id="search-select" name="searchPath"><option value="all">Entire Site</option><option value="AWSMarketplace">AMIs from AWS Marketplace</option><option value="amis">AMIs from All Sources</option><option value="articles">Articles &amp; Tutorials</option><option value="products_and_info">AWS Product Information</option><option value="case_studies">Case Studies</option><option value="customerapps">Customer Apps</option><option value="documentation">Documentation</option><option value="documentation-product">Documentation - This Product</option><option value="documentation-guide" selected>Documentation - This Guide</option><option value="datasets">Public Data Sets</option><option value="releasenotes">Release Notes</option><option value="solution_providers">Partners</option><option value="code">Sample Code &amp; Libraries</option></select><br><input id="search-query" name="searchQuery" type="text" placholder="$loc-search-search"><input id="search-button" src="images/search-button.png" alt="Go" type="image"></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="AWS Command Line Interface"><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="User Guide"><input type="hidden" name="doc_locale" value="en_us"></form></div><div id="toc"><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-chap-welcome.html">What Is the AWS CLI?</a></li><li class="awstoc opened"><a class="awstoc" href="cli-chap-getting-set-up.html">Getting Set Up</a><ul class="awstoc"><li class="awstoc closed"><a class="awstoc" href="installing.html">Installing the AWS CLI</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-uninstall.html">Uninstalling the AWS CLI</a></li></ul></li><li class="awstoc opened"><a class="awstoc" href="cli-chap-getting-started.html">Configuring the AWS CLI</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-http-proxy.html">Using an HTTP Proxy</a></li><li class="awstoc leaf"><a class="awstoc selected" href="cli-roles.html">Assuming a Role</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-command-completion.html">Command Completion</a></li></ul></li></ul></li><li class="awstoc leaf"><a class="awstoc" href="tutorial-ec2-ubuntu.html">Tutorial: Using Amazon EC2</a></li><li class="awstoc closed"><a class="awstoc" href="cli-chap-using.html">Using the AWS CLI</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="getting-help.html">Getting Help</a></li><li class="awstoc leaf"><a class="awstoc" href="command-structure.html">Command Structure</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-using-param.html">Specifying Parameter Values</a></li><li class="awstoc leaf"><a class="awstoc" href="generate-cli-skeleton.html">Generate CLI Skeleton</a></li><li class="awstoc leaf"><a class="awstoc" href="controlling-output.html">Controlling Command Output</a></li><li class="awstoc leaf"><a class="awstoc" href="shorthand-syntax.html">Shorthand Syntax</a></li><li class="awstoc leaf"><a class="awstoc" href="pagination.html">Pagination</a></li></ul></li><li class="awstoc closed"><a class="awstoc" href="chap-working-with-services.html">Working with Services</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-dynamodb.html">DynamoDB</a></li><li class="awstoc closed"><a class="awstoc" href="cli-using-ec2.html">Amazon EC2</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-ec2-keypairs.html">Using Key Pairs</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-ec2-sg.html">Using Security Groups</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-ec2-launch.html">Using Instances</a></li></ul></li><li class="awstoc leaf"><a class="awstoc" href="cli-using-glacier.html">Amazon Glacier</a></li><li class="awstoc closed"><a class="awstoc" href="cli-iam.html">AWS Identity and Access Management</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="cli-iam-new-user-group.html">Create New IAM Users and Groups</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-iam-policy.html">Set an IAM Policy for an IAM User</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-iam-set-pw.html">Set an Initial Password for an IAM User</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-iam-create-creds.html">Create Security Credentials for an IAM User</a></li></ul></li><li class="awstoc closed"><a class="awstoc" href="cli-s3.html">Amazon S3</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="using-s3-commands.html">Using High-Level Amazon S3 Commands</a></li><li class="awstoc leaf"><a class="awstoc" href="using-s3api-commands.html">Using API Level (s3api) Commands</a></li></ul></li><li class="awstoc leaf"><a class="awstoc" href="cli-sqs-queue-sns-topic.html">Amazon SNS</a></li><li class="awstoc closed"><a class="awstoc" href="cli-using-swf.html">Amazon SWF</a><ul class="awstoc"><li class="awstoc leaf"><a class="awstoc" href="swf-commands-by-category.html">List of Amazon SWF Commands</a></li><li class="awstoc leaf"><a class="awstoc" href="cli-using-swf-domains.html">Working with Amazon SWF Domains</a></li></ul></li></ul></li></ul></div></div><div id="main-column"><div id="main"><div id="main-content"><div id="breadcrumbs"><table summary="Breadcrumbs"><tr><td><div class="navheader"><div class="breadcrumb"><a href="http://aws.amazon.com/documentation/">AWS Documentation</a> &raquo; <a href="http://aws.amazon.com/documentation/cli">AWS Command Line Interface</a> &raquo; <a href="index.html">AWS Command Line Interface</a> &raquo; <a href="cli-chap-getting-set-up.html">Getting Set Up with the AWS Command Line Interface</a> &raquo; <a href="cli-chap-getting-started.html">Configuring the AWS Command Line Interface</a> &raquo; <span class="breadcrumb">Assuming a Role</span></div></div></td></tr></table></div><div id="main-col-body"><div></div><div class="section"><div class="titlepage"><div><div><h1 class="topictitle">Assuming a Role</h1></div></div></div><p>You can configure the AWS Command Line Interface to use a role by creating a profile for the role in the
      <code class="filename">~/.aws/config</code> file. The following example shows a role profile named
      <code class="code">marketingadmin</code> that is assumed by the default profile.</p><pre class="programlisting"><code class="nohighlight">[profile <em class="replaceable"><code>marketingadmin</code></em>]
role_arn = arn:aws:iam::<em class="replaceable"><code>123456789012</code></em>:role/<em class="replaceable"><code>marketingadmin</code></em>
source_profile = default</code></pre><p>In this case, the default profile is an IAM user with credentials and permission to assume a
    role named marketingadmin. To access the role, you create a named profile. Instead of
    configuring this profile with credentials, you specify the ARN of the role and the name of the
    profile that has access to it.</p><div class="highlights"><p><strong>Topics</strong></p><ul><li><a href="cli-roles.html#cli-role-prepare">Configuring and Using a Role</a></li><li><a href="cli-roles.html#cli-roles-mfa">Using Multifactor Authentication</a></li><li><a href="cli-roles.html#cli-roles-xaccount">Cross Account Roles</a></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="cli-role-prepare">Configuring and Using a Role</h2></div></div></div><p>When you run commands using the role profile, the AWS CLI uses the source profile's
      credentials to call AWS Security Token Service and assume the specified role. The source profile must have
      permission to call <code class="code">sts:assume-role</code> against the role, and the role must have a
      trust relationship with the source profile to allow itself to be assumed.</p><p>Create a new role in IAM with the permissions that you want users to assume by following
      the procedure under <a class="ulink" href="http://docs.aws.amazon.com/IAM/latest/UserGuide/roles-creatingrole-user.html" target="_blank"> Creating a Role
        to Delegate Permissions to an IAM User</a> in the <span class="emphasis"><em>AWS Identity and Access Management User
        Guide</em></span>. If the role and the target IAM user are in the same account, you can enter
      your own account ID when configuring the role's trust relationship.</p><p>After creating the role, modify the trust relationship to allow the IAM user to assume
      it. The following example shows a trust relationship that allows a role to be assumed by an
      IAM user named <code class="code">jonsmith</code>:</p><pre class="programlisting"><code class="nohighlight">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::<em class="replaceable"><code>123456789012</code></em>:user/<em class="replaceable"><code>jonsmith</code></em>"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre><p>Next, grant your IAM user permission to assume the role. The following example shows an
      AWS Identity and Access Management policy that allows an IAM user to assume the <code class="code">marketingadmin</code>
      role:</p><pre class="programlisting"><code class="nohighlight">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "sts:AssumeRole",
      "Resource": "arn:aws:iam::<em class="replaceable"><code>123456789012</code></em>:role/<em class="replaceable"><code>marketingadmin</code></em>"
    }
  ]
}</code></pre><p>The user doesn't need to have any additional permissions to run commands using the role
      profile. If you want your users to be able to access AWS resources without using the role,
      apply additional inline or managed policies for those resources.</p><p> With the role profile, role permissions, trust relationship and user permissions applied,
      you can assume the role at the command line by using the <code class="code">profile</code> option, for
      example:</p><pre class="programlisting"><code class="nohighlight">$ <strong class="userinput"><code>aws s3 ls --profile <em class="replaceable"><code>marketingadmin</code></em></code></strong></code></pre><p>To use the role for multiple calls, you can set the AWS_DEFAULT_PROFILE environment
      variable for the current session from the command line:</p><p><span class="bold"><strong>Linux, OS X, or Unix</strong></span></p><pre class="programlisting"><code class="nohighlight">$ <strong class="userinput"><code>export AWS_DEFAULT_PROFILE=marketingadmin</code></strong></code></pre><p><span class="bold"><strong>Windows</strong></span></p><pre class="programlisting"><code class="nohighlight">&gt; <strong class="userinput"><code>set AWS_DEFAULT_PROFILE=marketingadmin</code></strong></code></pre><p>For more information on configuring IAM users and roles, see <a class="ulink" href="http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_WorkingWithGroupsAndUsers.html" target="_blank"> Users and Groups</a> and
        <a class="ulink" href="http://docs.aws.amazon.com/IAM/latest/UserGuide/roles-toplevel.html" target="_blank"> Roles</a> in the <span class="emphasis"><em>AWS Identity and Access Management
        User Guide</em></span>. </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="cli-roles-mfa">Using Multifactor Authentication</h2></div></div></div><p>For additional security, you can require users to provide a one time key generated from a
      multifactor authentication device or mobile app when they attempt to make a call using the
      role profile.</p><p>First, modify the trust relationship on the role to require multifactor
      authentication:</p><pre class="programlisting"><code class="nohighlight">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "",
      "Effect": "Allow",
      "Principal": { "AWS": "arn:aws:iam::123456789012:user/jonsmith" },
      "Action": "sts:AssumeRole",
      <strong class="userinput"><code>"Condition": { "Bool": { "aws:MultiFactorAuthPresent": true } }</code></strong>
    }
  ]
}</code></pre><p>Next, add a line to the role profile that specifies the ARN of the user's MFA
      device:</p><pre class="programlisting"><code class="nohighlight">[profile marketingadmin]
role_arn = arn:aws:iam::123456789012:role/marketingadmin
source_profile = default
<strong class="userinput"><code>mfa_serial = arn:aws:iam::<em class="replaceable"><code>123456789012</code></em>:mfa/<em class="replaceable"><code>jonsmith</code></em></code></strong></code></pre><p>The role requires MFA in order to be assumed by any user, but the actual MFA device ARN is
      specified in the role profile's configuration on the user's machine and varies between users.
      This allows many users to assume the same role using their individual MFA devices.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="cli-roles-xaccount">Cross Account Roles</h2></div></div></div><p>You can enable IAM users to assume roles that belong to different accounts by configuring
      the role as a cross account role. During role creation, set the role type to one of the
      options under <span class="guilabel">Role for Cross-Account Access</span> and optionally select
        <span class="guilabel">Require MFA</span>. The <span class="guilabel">Require MFA</span> option configures the
      appropriate condition in the trust relationship as described in <a class="link" href="cli-roles.html#cli-roles-mfa" title="Using Multifactor Authentication">Using Multifactor Authentication</a>.</p><p>If you use an <a class="ulink" href="http://docs.aws.amazon.com/STS/latest/UsingSTS/ts-delegating-externalid.html" target="_blank">external ID</a>
      to provide additional control over who can assume a role across accounts, add an
        <code class="code">external_id</code> parameter to the role profile: </p><pre class="programlisting"><code class="nohighlight">[profile crossaccountrole]
role_arn = arn:aws:iam::123456789012:role/xaccount
source_profile = default
mfa_serial = arn:aws:iam::123456789012:mfa/jonsmith
<strong class="userinput"><code>external_id = <em class="replaceable"><code>123456</code></em></code></strong></code></pre></div></div></div><img src="images/expanderarrow.png" style="display:none;height:0;width:0"><div id="main-col-footer"><div id="doc-conventions"><a target="_top" href="http://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div id="next"><a class="awstoc" accesskey="p" href="cli-http-proxy.html">&laquo; Previous </a><a class="awstoc" accesskey="n" href="cli-command-completion.html">Next &raquo;</a></div><div id="copyright-main-footer">&copy; 2016, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div></div></div></div><div id="right-expanded"><div id="right-content-wrapper"><div id="right-col-header"><a id="pdf_link" href="aws-cli.pdf"> PDF </a><text> | </text><a target="_blank" href="http://www.amazon.com/dp/B00Q7K4HFG">Kindle </a></div><div id="pagetoc"><p>On this page:</p><ul class="pagetoc"><li class="pagetoc" name="Configuring and Using a Role"><a class="pagetoc" href="#cli-role-prepare">Configuring and Using a Role</a></li><li class="pagetoc" name="Using Multifactor Authentication"><a class="pagetoc" href="#cli-roles-mfa">Using Multifactor Authentication</a></li><li class="pagetoc" name="Cross Account Roles"><a class="pagetoc" href="#cli-roles-xaccount">Cross Account Roles</a></li></ul></div></div></div></div></div><div id="footer"><div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20Command%20Line%20Interface&amp;hidden_guide_name=User%20Guide&amp;hidden_api_version=&amp;hidden_file_name=cli-roles"><i class="fa fa-envelope-o"></i></a></div><div id="footer_toggle" class="mediaobject"><img id="footer_toggle_img" src="images/expanderarrow.png"><img id="footer_toggle_img_collapse" class="hide" src="images/expanderarrowright.png"></div><div id="footer-left"><a target="_top" href="http://aws.amazon.com/terms">Terms of Use</a> | &copy; 2016, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div><div id="footer-right"><div id="feedback"><div id="forums"><a id="forum_link" target="_blank" href="http://forums.aws.amazon.com/forum.jspa?forumID=150">Have a question? Try the Forums.</a></div><div id="feedback-message">Did this page help you?</div><div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes2c87.html?topic_id=cli-roles">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno2c87.html?topic_id=cli-roles">No</a></div><div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20Command%20Line%20Interface&amp;hidden_guide_name=User%20Guide&amp;hidden_api_version=&amp;hidden_file_name=cli-roles">Feedback</a></div></div></div></div><noscript><div><div><div><div id="error_messages"><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" style="float: left;" alt="Warning"><div id="js_error_message"><strong>Javascript is disabled or is unavailable in your browser.</strong><br> To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions. </div></div></div></div></div></noscript><!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript"><!--

            // Documentation Service Name
            s.prop66='AWS Command Line Interface';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='User Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript"><!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="http://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt=""></noscript><!--/DO NOT REMOVE/--><!-- End SiteCatalyst code version: H.25.2. --></body>
<!-- Mirrored from docs.aws.amazon.com/cli/latest/userguide/cli-roles.html by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 08 Jun 2016 08:36:33 GMT -->
</html>